<!DOCTYPE html>
<html lang="en">
<head>
        <title>Many craft. Wow. Such create : Fixing text highlighting in tmux/man/less</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="http://maciej.lasyk.info/theme/css/main.css" type="text/css" />
        <link href="http://maciej.lasyk.info/" type="application/atom+xml" rel="alternate" title="Many craft. Wow. Such create ATOM Feed" />
        <link href="http://maciej.lasyk.info/feeds/rss.xml" type="application/atom+xml" rel="alternate" title="Many craft. Wow. Such create RSS Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://maciej.lasyk.info/css/ie.css"/>
                <script src="http://maciej.lasyk.info/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://maciej.lasyk.info/css/ie6.css"/><![endif]-->

</head>

<body>
	<div id="wrap" style="width:850px">
	    <div id="container" style="width:560px">


            <div class="entry">
        
<header>
<h1><a href="http://maciej.lasyk.info" id="site-title">  </a>         <a href="http://maciej.lasyk.info/2015/Dec/21/fixing-text-highlighting-in-tmuxmanless/" id="page-title">Fixing text highlighting in tmux/man/less</a></h1>
<time datetime="2015-12-21T00:00:00+01:00">Mon 21 December 2015</time></header>
<article>
    <p><center><img alt="tmux" src="http://maciej.lasyk.info/images/tmux.png" /></center></p>
<p>So today I spotted an in issue while using search function when reading man
pages. Basically <strong>I didn't have results highlighted</strong>, but search worked
(position of screen scrolled to somewhere near first spotted result).</p>
<p>Firstly tried to blame <a href="https://en.wikipedia.org/wiki/Terminator_%28terminal_emulator%29">Terminator</a>
but I had same issue in <a href="https://en.wikipedia.org/wiki/Guake">Guake</a> session. Finally I found that
the common denominator here was tmux. Outside of tmux there was no such problems.</p>
<h3>Solution?</h3>
<p>So I dug the internets and <a href="http://tmux.svn.sourceforge.net/viewvc/tmux/trunk/FAQ">found a solution</a>:</p>
<p><em>vim displays reverse video instead of italics, while less displays italics
  (or just regular text) instead of reverse. What's wrong?</em></p>
<p><em>Screen's terminfo description lacks italics mode and has standout mode in its
place, but using the same escape sequence that urxvt uses for italics. This
means applications (like vim) looking for italics will not find it and might
turn to reverse in its place, while applications (like less) asking for
standout will end up with italics instead of reverse. To make applications
aware that tmux supports italics and to use a proper escape sequence for
standout, you'll need to create a new terminfo file with modified sgr, smso,
rmso, sitm and ritm entries:</em></p>
<div class="highlight"><pre><span></span>$ mkdir <span class="nv">$HOME</span>/.terminfo/
$ <span class="nv">screen_terminfo</span><span class="o">=</span><span class="s2">&quot;screen&quot;</span>
$ infocmp <span class="s2">&quot;</span><span class="nv">$screen_terminfo</span><span class="s2">&quot;</span> <span class="p">|</span> sed <span class="se">\</span>
  -e <span class="s1">&#39;s/^screen[^|]*|[^,]*,/screen-it|screen with italics support,/&#39;</span> <span class="se">\</span>
  -e <span class="s1">&#39;s/%?%p1%t;3%/%?%p1%t;7%/&#39;</span> <span class="se">\</span>
  -e <span class="s1">&#39;s/smso=[^,]*,/smso=\\E[7m,/&#39;</span> <span class="se">\</span>
  -e <span class="s1">&#39;s/rmso=[^,]*,/rmso=\\E[27m,/&#39;</span> <span class="se">\</span>
  -e <span class="s1">&#39;$s/$/ sitm=\\E[3m, ritm=\\E[23m,/&#39;</span> &gt; /tmp/screen.terminfo
$ tic /tmp/screen.terminfo
</pre></div>


<p><em>And tell tmux to use it in ~/.tmux.conf:</em></p>
<div class="highlight"><pre><span></span>set -g default-terminal &quot;screen-it&quot;
</pre></div>


<p><em>If your terminal supports 256 colors, use:</em></p>
<div class="highlight"><pre><span></span>$ <span class="nv">screen_terminfo</span><span class="o">=</span><span class="s2">&quot;screen-256color&quot;</span>
</pre></div>


<p><em>instead of "screen".</em></p>
<h3>Ansible playbook for this</h3>
<p>So I created <a href="https://github.com/docent-net/fedora-desktop-ansible/commit/d314aedd61e6973df3de16bd557de7e3f3aecb3d">Ansible implementation</a>
and put in inside of <a href="https://github.com/docent-net/fedora-desktop-ansible">fedora-desktop-ansible</a>.</p>
<p>You can test it with:</p>
<div class="highlight"><pre><span></span>ansible-playbook master.yml --tags tmux
</pre></div>
    <h2>Comments</h2>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
       var disqus_shortname = 'manycraft';
       var disqus_identifier = '2015/Dec/21/fixing-text-highlighting-in-tmuxmanless/';
       var disqus_url = 'http://maciej.lasyk.info/2015/Dec/21/fixing-text-highlighting-in-tmuxmanless/';
       (function() {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] ||
             document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the comments.</noscript>
</article>
            </div>
        </div>

        <div id="sidebar">
            <h1><a href="http://maciej.lasyk.info" title="title">Many craft. Wow. Such create</a><br><img
                src="/theme/img/chunkybacon.png"></h1>
            <span class="description"> </span>
        </div>

        <div id="feedsbar">
            <ul>
            <li><a href="/feeds/rss.xml">RSS</a> | <a href="/feeds/atom.xml">Atom</a></li>
            </ul>
        </div>

        <div id="tagcloud">
        <nav>
            <ul class="tagcloud">
            </ul>
        </nav>
        </div>

        <div id="footer">
            <div id="credits">
                <span>Adapted from <a
                        href="http://wordpress.org/themes/monospace">Monospace</a>
                || Created with <a href="">Pelican</a> || Hosted with <a
                    href="http://docker.io/">Docker</a></span>
                <p>content copyrights &copy; Maciej Lasyk</p>
            </div>
                
        </div>

    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-61452-19");
    pageTracker._trackPageview();
    } catch(err) {}</script>
    <script type="text/javascript">
        var pkBaseURL = (("https:" == document.location.protocol) ? "https://analytics.lasyk.info/" : "http://analytics.lasyk.info/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
    </script><script type="text/javascript">
    try {
    var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
    piwikTracker.trackPageView();
    piwikTracker.enableLinkTracking();
    } catch( err ) {}
    </script><noscript><p><img src="http://analytics.lasyk.info/piwik.php?idsite=1" style="border:0" alt="" /></p></noscript>
<script type="text/javascript">
    var disqus_shortname = 'manycraft';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

    </div>

</body>
</html>