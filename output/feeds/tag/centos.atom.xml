<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Many craft. Wow. Such create</title><link href="http://maciej.lasyk.info/" rel="alternate"></link><link href="http://maciej.lasyk.info/feeds/tag/centos.atom.xml" rel="self"></link><id>http://maciej.lasyk.info/</id><updated>2015-02-09T00:00:00+01:00</updated><entry><title>iSCSI boot in RHEL/CentOS7 broken</title><link href="http://maciej.lasyk.info/2015/Feb/09/iscsi-boot-in-rhelcentos7-broken/" rel="alternate"></link><updated>2015-02-09T00:00:00+01:00</updated><author><name>Maciej Lasyk</name></author><id>tag:maciej.lasyk.info,2015-02-09:2015/Feb/09/iscsi-boot-in-rhelcentos7-broken/</id><summary type="html">&lt;p&gt;&lt;center&gt;&lt;img alt="RHEL" src="http://maciej.lasyk.info/images/rhel-logo.png" /&gt;&lt;/center&gt;&lt;/p&gt;
&lt;h3&gt;WAT?&lt;/h3&gt;
&lt;p&gt;Today while rolling up new host in my company I hit the following issue after
successfully installing CentOS7 on remote iSCSI drive. I just rebootted the
machine and after GRUB done it's job I just got:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="o"&gt;[&lt;/span&gt;   2.375332&lt;span class="o"&gt;]&lt;/span&gt; i8042: No controller found
&lt;span class="o"&gt;[&lt;/span&gt;   2.592960&lt;span class="o"&gt;]&lt;/span&gt; dracut: FATAL: For argument 
    &lt;span class="s1"&gt;&amp;#39;ip=::::localhost.localdomain:eno1: none&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;Value &lt;span class="s1"&gt;&amp;#39;none&amp;#39;&lt;/span&gt; 
    without static configuration does not make sanse
&lt;span class="o"&gt;[&lt;/span&gt;   2.593074&lt;span class="o"&gt;]&lt;/span&gt; dracut: Refusing to &lt;span class="k"&gt;continue&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;   3.197719&lt;span class="o"&gt;]&lt;/span&gt; System halted.
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;What's that?&lt;/h3&gt;
&lt;p&gt;The answer is &lt;a href="https://access.redhat.com/solutions/905003"&gt;here&lt;/a&gt;. Simply
installer is broken and it creates broken grub entry for iSCSI nodes.&lt;/p&gt;
&lt;h3&gt;How to fix this?&lt;/h3&gt;
&lt;p&gt;There're many ways. I just rebooted the box, entered the grub edit mode and
fixed the boot param replacing:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;linux16 /vmlinuz-3.10.0-123.el7.x86_64 &lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt; 
    vconsole.font&lt;span class="o"&gt;=&lt;/span&gt;latarcyrheb-sun16 
    &lt;span class="nv"&gt;ip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;::::localhost.localdomain:eno1:none &lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;with this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;linux16 /vmlinuz-3.10.0-123.el7.x86_64 &lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt; 
    vconsole.font&lt;span class="o"&gt;=&lt;/span&gt;latarcyrheb-sun16 
    &lt;span class="nv"&gt;ip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;192.168.1.15::192.168.1.1:255.255.252.0:localhost.localdomain:eno1:none &lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Where &lt;strong&gt;192.168.1.15&lt;/strong&gt; is the initiator IP addr and &lt;strong&gt;192.168.1.1&lt;/strong&gt; is the 
gateway IP.&lt;/p&gt;
&lt;p&gt;Of course that above is just a way to successfully boot into the system. After 
boot the grub2.cfg is still broken so now it's the time for a permanent
solution:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Fix above again in &lt;strong&gt;/etc/sysconfig/grub&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Rebuild the grub configuration: &lt;strong&gt;&lt;em&gt;grub2-mkconfig -o /boot/grub2/grub.cfg&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;That's all. Just reboot and confirm it's working fine&lt;/li&gt;
&lt;/ul&gt;</summary><category term="rhel"></category><category term="centos"></category><category term="iscsi"></category><category term="boot"></category><category term="netboot"></category></entry><entry><title>Network Manager Dispatcher</title><link href="http://maciej.lasyk.info/2014/Sep/14/network-manager-dispatcher/" rel="alternate"></link><updated>2014-09-14T11:46:00+02:00</updated><author><name>Maciej Lasyk</name></author><id>tag:maciej.lasyk.info,2014-09-14:2014/Sep/14/network-manager-dispatcher/</id><summary type="html">&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/NetworkManager"&gt;NetworkManager&lt;/a&gt; is often 
associated with some voodoo - network - magic tool, that does the work on 
laptop, but better switch it off on server. I won't argue about that, just 
wanted to give you something I personally think make NM more usable.&lt;/p&gt;
&lt;p&gt;So it is the &lt;strong&gt;/etc/NetworkManager/dispatcher.d&lt;/strong&gt; - this is directory under
which lay scripts which will be executed on network change. Following
man-pages:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;NetworkManager will execute scripts in the /etc/NetworkManager/dispatcher.d 
directory in alphabetical order in response to network events. Each script 
should be a regular executable file, owned by root.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Furthermore, it must not be writable by group or other, and not setuid.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Each script receives two arguments, the first being the interface name of
the device just activated, and second an action.&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;down&lt;/strong&gt; - The interface has been deactivated.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;vpn-up&lt;/strong&gt; - A VPN connection has been activated.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;vpn-down&lt;/strong&gt; - A VPN connection has been deactivated.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;hostname&lt;/strong&gt; - The system hostname has been updated. Use gethostname(2) to
  retrieve it.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;dhcp4-change&lt;/strong&gt; - The DHCPv4 lease has changed (renewed, rebound, etc).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;dhcp6-change&lt;/strong&gt; - The DHCPv6 lease has changed (renewed, rebound, etc).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So basically without manually detecting change in network events we may use the
tool that was created just for this particular goal.&lt;/p&gt;</summary><category term="network"></category><category term="centos"></category><category term="fedora"></category></entry><entry><title>Ansible Playbook for favtools</title><link href="http://maciej.lasyk.info/2014/Sep/12/ansible-playbook-for-favtools/" rel="alternate"></link><updated>2014-09-12T23:24:00+02:00</updated><author><name>Maciej Lasyk</name></author><id>tag:maciej.lasyk.info,2014-09-12:2014/Sep/12/ansible-playbook-for-favtools/</id><summary type="html">&lt;h3&gt;playbook&lt;/h3&gt;
&lt;p&gt;This rather doesn't fit my github repo ;)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;- name: Ensure my favorite tools are installed
  yum: &lt;span class="nv"&gt;pkg&lt;/span&gt;&lt;span class="o"&gt;={{&lt;/span&gt;item&lt;span class="o"&gt;}}&lt;/span&gt; &lt;span class="nv"&gt;state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;latest
  with_items:
    - strace
    - ltrace
    - tcpdump
    - vim
    - procps
    - sysstat
    - git
    - make
    - gcc
    - tmux
    - links
    - man
    - ntp
    - &lt;span class="nb"&gt;bind&lt;/span&gt;-utils
    - nmap
    - wget
    - telnet
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And there would be one &lt;a href="http://docs.ansible.com/playbooks_roles.html#role-dependencies"&gt;dependency&lt;/a&gt; here (&lt;a href="https://fedoraproject.org/wiki/EPEL"&gt;EPEL&lt;/a&gt; repo):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;- name: install epel repo
  yum: &lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm &lt;span class="nv"&gt;state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;present
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;That is only for starters; I'd add here also &lt;a href="http://www.sysdig.org/"&gt;sysdig&lt;/a&gt; and whole playbook for preparing user env.&lt;/p&gt;</summary><category term="ansible"></category><category term="centos"></category><category term="fedora"></category></entry></feed>